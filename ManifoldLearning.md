# 流形学习  
## 1.概念  
#### 一句话总结：流形学习用于将高维数据降维映射到低维欧式空间。  
  
 流形（manifold）是几何中的一个概念，它是高维空间中的几何结构，即空间中的点构成的集合。可以简单的将流形理解成二维空间的曲线，三维空间的曲面在更高维空间的推广。下图是三维空间中的一个流形，这是一个卷曲面：
![image](https://pic3.zhimg.com/80/v2-7dcc5b2aa752a5af8f508202c6862f52_720w.webp)  
可以很简单地将流形学习理解为将这个卷曲面展开，铺平在二维表面，同时保持了这个面上数据的相对位置关系。  
流形学习（manifold learning）假设数据在高维空间的分布位于某一更低维的流形上，基于这个假设来进行数据的分析。对于降维，要保证降维之后的数据同样满足与高维空间流形有关的几何约束关系。除此之外，流形学习还可以用实现聚类，分类以及回归算法。  
  
假设有一个N维空间中的流形M，即M为N维欧氏空间的一个真子集，流形学习降维算法要实现的是M到n维空间的映射，其中n<<N。即将N维空间中流形M上的点映射为n维空间中的点。下面介绍几种典型的流形降维算法，包括局部线性映射，拉普拉斯特征映射，局部保持投影，等距映射。  

## 2.局部线性嵌入（LLE）  
#### LLE首先假设数据在较小的局部是线性的，也就是说，某一个数据可以由它邻域中的几个样本来线性表示。  
##### 现有库：from sklearn.manifold._locally_linear import locally_linear_embedding  

主要流程如下：  
1.计算样本数据间距离：欧式距离，余弦距离等；  
2.计算k邻近，其中k是输入，为每个样本可以拥有的邻居数量； 
这一步在lle中的假设为xi可以由它的邻居们xij线性表示，并且在降维之后，这些邻居依旧可以表示它，也就是它们的权重几乎不变：  
![image](https://img-blog.csdnimg.cn/20201106160725390.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyOTAyOTk3,size_16,color_FFFFFF,t_70#pic_center)
3.初始化权重矩阵，权重系数应有归一化限制；  
4.找到 xi与k个近邻之间的线性关系，这显然是个回归问题，通过矩阵和拉格朗日子乘法来求解这个最优化问题；    
5.将原样本映射到低维空间，本质其实是取输入数据M的最小的d个非零特征值对应的特征向量，其中d是需要降维到的维度；  
  
lle相对于isomap的计算量要小了很多，但是不同k值的选择可能对结果影响较大：  
![image](https://pic4.zhimg.com/80/v2-e4a28aec12e3fe274e735682c225ec6f_720w.webp)
  
