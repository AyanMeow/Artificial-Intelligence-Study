# 机器学习相关  
## 1.回归算法   
### 1.1线性回归  
用连续线（平面）去拟合离散数据点。  
#### 似然函数：
对于未知参数θ的关于离散型或连续性随机变量(y|x)，及其观测样本yi|xi在y0....yi处的概率或概率密度。  
#### 残差平方和（SSE）：
预测样本与真实样本差的平方和。   
#### R2指标：
1-（残差平方和/真实样本方差和），R2越接近1说明模型拟合越好。   
#### 梯度下降算法：
针对多参数凸函数的优化问题，找到其“最低点”。即在寻找梯度不断下降直至梯度=0的点。  
1.全体（批量）梯度下降：每次考虑所有样本，速度较慢；   
2.随机梯度下降：迭代速度快，但不稳定，容易陷入局部最优；  
3.小批量梯度下降：每次更新选择一小部分数据，相对较为合适。mini-batch。  
### 1.2逻辑回归  
实际上算是二分类模型。名字来源于logistic分布，存在一个线性决策边界。  
#### 先验概率：
指根据以往经验和分析。在实验或采样前就可以得到的概率。  
#### 后验概率：
指某件事已经发生，想要计算这件事发生的原因是由某个因素引起的概率。
  
假设我们现在有两个盒子，分别为红色和蓝色。在红色盒子中放着2个苹果和6个橙子，在蓝色盒子中放着1个橙子和3个苹果。   
绿色表示苹果，橙色代表橙子。假设我们每次实验的时候会随机从某个盒子里挑出一个水果，随机变量B（box）表示挑出的是哪个盒子，并且$P(B=blue) = 0.6$（蓝色盒子被选中的概率），$P(B=red) = 0.4$（红色盒子被选中的概率）。随机变量$F（fruit）$表示挑中的是哪种水果，F的取值为"a (apple)"和"o (orange)"。   
现在假设我们已经得知某次实验中挑出的水果是orange，那么这个orange是从红色盒子里挑出的概率是多大呢？依据贝叶斯公式有：  
$P(B=red|F=o)=\frac{P(F=o|B=red)P(B=red)}{P(F=o)}=\frac{2}{3}$   
易得：
$P(B=blue|F=o)=\frac{1}{3}$   
在上面的计算过程中，我们将P(B=blue)称为先验概率（prior probability），因为我们在得到F是“a”或者“o”之前，就可以得到 
 。同理，将P(B=red|F=o)称为后验概率，因为我们在完整的一次实验之后也就是得到了F的具体取值之后才能得到这个概率。  
 ##### 在逻辑回归任务中常常使用梯度上升求取最大值，于是引入 $J(θ)=-\frac{1}{m}l(θ)$ 转换为梯度下降任务  
 常见的是二分类sigmoid函数或多分类softmax多分类函数。   
 
### 1.3正则化   
给loss function加上正则化项，能使得新得到的优化目标函数h = f+normal，需要在f和normal中做一个权衡（trade-off），如果还像原来只优化f的情况下，那可能得到一组解比较复杂，使得正则项normal比较大，那么h就不是最优的，因此可以看出加正则项能让解更加简单，符合奥卡姆剃刀理论，同时也比较符合在偏差和方差（方差表示模型的复杂度）分析中，通过降低模型复杂度，得到更小的泛化误差，降低过拟合程度。  
#### 1.3.1 L1正则化   
加入了L1范数的的解，即求解 $C||w_1||=|w_1|+|w_2|$ 的最小值的解。其解一定是某个菱形和某条原函数等高线的切点。  
![image](https://pic2.zhimg.com/80/v2-3fef81c912c4ac0fd8e61a007139f855_720w.webp)  
经过观察可以看到，几乎对于很多原函数等高曲线，和某个菱形相交的时候及其容易相交在坐标轴（比如上图），也就是说最终的结果，解的
某些维度及其容易是0，比如上图最终解是 $w=(0,x)$ ，这也就是我们所说的L1更容易得到稀疏解（解向量中0比较多）的原因。   
* L1正则化就是在loss function后边所加正则项为L1范数，加上L1范数容易得到稀疏解（0比较多）。  $h=f+C|x|$  *   

#### 1.3.2 L2正则化   
当加入L2正则化的时候，分析和L1正则化是类似的，也就是说我们仅仅是从菱形变成了圆形而已，同样还是求原曲线和圆形的切点作为最终解。当然与L1范数比，我们这样求的L2范数的从图上来看，不容易交在坐标轴上，但是仍然比较靠近坐标轴。因此这也就是我们老说的，L2范数能让解比较小（靠近0），但是比较平滑（不等于0）。   
* L2正则化就是loss function后边所加正则项为L2范数的平方，加上L2正则相比于L1正则来说，得到的解比较平滑（不是稀疏），但是同样能够保证解中接近于0（但不是等于0，所以相对平滑）的维度比较多，降低模型的复杂度。 $h=f+Cx^2$  *
  
### 1.4范数  
#### 任意范数： $||x||p=\sqrt[p]{\sum_ix_i^p}$  
#### L0范数： $||x||0=\sqrt[0]{\sum_ix_i^0}=j$ ，表示向量 {x} 中非0元素的个数；比如压缩感知 (compressive sensing)，我们很多时候希望最小化向量的 l_0 -范数。 但它是一个NP-hard问题，即直接求解它很复杂、也不可能找到解。    
#### L1范数： $||x||1=\sqrt[1]{\sum_ix_i^1}=\sum_i|x_i|$ ，等于向量中所有元素和，压缩感知模型是将 l_0 -范数最小化问题转换成 l_1 -范数最小化问题。    
#### L2范数： $||x||2=\sqrt[2]{\sum_ix_i^2}$ ，表示向量（或矩阵）的元素平方和开根号  
  
### 1.5支持向量机（SVM）    
支持向量机（support vector machines, SVM）是一种二分类模型，它的基本模型是定义在特征空间上的间隔最大的线性分类器，间隔最大使它有别于感知机；SVM还包括核技巧，这使它成为实质上的非线性分类器。  
![image](https://pica.zhimg.com/v2-197913c461c1953c30b804b4a7eddfcc_r.webp?source=172ae18b&consumer=ZHI_MENG)  
#### 决策边界（support vector）：
选出来的离两边数据点边界点最远的曲线。  
#### 几何间隔：  
对于给定的数据集 $T$ 和超平面 $w\cdot x+b=0$ ，定义超平面关于样本点  $\left( x_i,y_i \right)$  的几何间隔为  
$\gamma_i=y_i\left(\frac{\boldsymbol{w}}{\lVert \boldsymbol{w} \rVert}\cdot \boldsymbol{x_i}+\frac{b}{\lVert \boldsymbol{w} \rVert} \right)$   
其中 $\gamma=\underset{i=1,2...,N}{\min}\gamma_i$ 就是支持向量到超平面的距离。   
SVM学习的基本想法是求解能够正确划分训练数据集并且几何间隔最大的分离超平面。对于线性可分的数据集来说，这样的超平面有无穷多个（即感知机），但是几何间隔最大的分离超平面却是唯一的。  
经过推导之后，问题  $\underset{w,b}{\max}\gamma$  转化为 $\underset{w,b}{\min}\frac{1}{2}\lVert\boldsymbol{w}\rVert^2$    
这是一个含有不等式约束的凸二次规划问题，可以对其使用拉格朗日乘子法得到其对偶问题（dual problem）。 
#### 核变换：与KPCA想法相同，将非线性可分空间的数据通过核函数映射到高维线性可分空间，再进行分割。  
线性核函数—： $K(x,y)=x^Ty+c$ 其中c是常数。         
常用核函数——高斯核函数： $K(x,y)=\exp(\frac{||x-y||^2}{2\sigma^2})$    
