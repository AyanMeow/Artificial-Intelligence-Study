反正在实际的产品使用中，这种机器学习应该是用不上啦。

从公司的角度出发，“实用性”永远是第一位的。首先，这种理论上不可解释性和不能到满点的准确率就导致理论在实际中很难落地；其次，根本没有办法去平衡安全性和用户体验。比如在舍弃用户体验和提升一点点安全性之间，企业怎么选很明显。

人工也是大问题。就算用，算法也只能作为辅助，最终靠人来处理。

作为企业的安全，更多的就是一种求稳？也就是在不影响业务的情况下，尽可能对安全系统进行优化。理论还是得为实际让步。

如果真的要看的话，那也得从实用性角度出发。所以与其依靠IDS给出精准的判断，不如结合几个更具有说服力的方案（比如语义分析，比如行为分析），然后给出结果。

说到最后，能搞攻击的还是太少了。大部分人不还是防御，而且是最基础的防御。所以感觉搞安全还是药丸。

#### ·基于语义分析的入侵检测系统

**特征提取**：从原始数据中提取特征，包括网络流量数据、日志信息、系统调用记录等。这种特征的提取目的是建立一种正常的行为模式，从而对异常行为进行检测。

**语义理解**：提取特征输入语义分析引擎中，理解这些特征的含义。包括网络协议解析、应用层协议识别、理解日志信息中的时间、分析系统调用的目的。

**行为建模**：基于特征，可以对正常的行为进行建模，包括正常的通信模式、用户活动模式、操作系统模式等。也就是建立一个正常行为的范本。模型的选择通常包括基于机器学习的模型（如聚类、分类、异常检测模型）、基于规则的模型（如规则引擎）、基于图论的模型等。选择的模型应该能够适应数据的特点，并且能够在实时或批处理情况下进行推断。

**异常检测**：通过实时监控，对实时数据进行监控，与建立的正常模型进行比较。如果检测出来偏离（类似于聚类不在同一点上），则证明该行为可能是异常。

**威胁分析**：检测到异常之后，通过语义分析判断这个异常行为的威胁性，包括意图识别、攻击路线确定、影响评估等。

**应急响应**：根据威胁，给出相应的应急措施。

#### ·IDS中的规则制定

1. **了解网络环境**：
   - 理解你要保护的网络环境，包括网络拓扑、重要资产、业务流程等。这有助于确定哪些区域或系统需要特别关注和保护。
2. **分析威胁情报**：
   - 关注最新的威胁情报，了解当前的威胁趋势和攻击技术。这可以帮助你识别潜在的威胁，并为制定规则提供参考。
3. **确定规则目标**：
   - 确定你要制定规则的具体目标，例如检测特定类型的攻击（如SQL 注入、跨站脚本等）、防止恶意流量（如端口扫描、DDoS 攻击等）等。
4. **编写规则**：
   - 使用 IDS/IPS 系统所支持的规则语言（如 Snort 规则语言）编写规则。规则应该包括动作、条件和选项。动作指定规则匹配时要执行的操作，条件指定要匹配的内容或特征，选项提供了额外的信息或修饰符。
   - 规则应该尽可能具体和准确，以避免误报和漏报。在编写规则时，可以利用正则表达式、关键字、特定协议字段等进行匹配。
5. **测试规则**：
   - 在实际环境中测试规则，确保规则能够准确地检测到攻击，并且不会对正常流量产生误报。可以使用已知的攻击模式或测试工具来验证规则的有效性。
6. **优化规则**：
   - 根据测试结果和实际使用情况对规则进行优化。可以调整规则的条件、选项或动作，以提高规则的准确性和效率。
7. **持续更新**：
   - 定期审查和更新规则，以适应不断变化的威胁环境和网络需求。及时更新规则可以帮助你及时应对新出现的威胁和攻击。

总的来说，制定入侵检测系统中的规则需要综合考虑网络环境、威胁情报和实际需求，编写**准确有效的规则**是确保系统安全的重要步骤之一。

#### ·snort规则

入侵行为往往会具备某些特征（如流量，包头等），**snort则是利用提取到的特征去制定规则**。snort 1.x可以对网络层与传输层信息的分析，snort 2.x增加了对应用层头部的支持。

**·规则结构**

所有的规则都可以分为两个逻辑组成部分：规则头部和规则选项。

|                         规则头部                         |                      规则选项                      |
| :------------------------------------------------------: | :------------------------------------------------: |
| 包含规则所做的动作的信息，也可以包含于包所对比的一些条件 | 包含一个告警信息以及包的哪个部分被用来产生这个信息 |

一条规则可以用来探测一个或多个类型的入侵活动，一个好的规则可以用来探测多种入侵特征。

规则头部：

|                                                      动作                                                      |             协议             |                                        地址                                        |                  端口                  |                                                                                 方向                                                                                 | 地址 | 端口 |
| :------------------------------------------------------------------------------------------------------------: | :--------------------------: | :---------------------------------------------------------------------------------: | :-------------------------------------: | :------------------------------------------------------------------------------------------------------------------------------------------------------------------: | ---- | ---- |
| 当规则与包比对并**符合条件时**，会采取什么类型的动作。通常的动作时产生告警或记录日志或向其他规则发出请求 | 在一个特定协议的包上应用规则 | 关键字”any”可以被用来定义任何地址。地址就是由直接的数字型ip地址和一个CIDR块组成的 | 关键字"any"或者范围操作符":"或否定符"!" | 方向操作符”->”表示规则所施加的流的方向。方向操作符左边的ip地址和端口号被认为是流来自的源主机，方向操作符右边的ip地址和端口信息是目标主机，还有一个双向操作符”<>” |      |      |

动作：

1. ###### pass

   这个动作高速Snort不理会这个包，这个动作在你不想检查特定的包的时候可以加快Snort的操作速度。例如：如果你在网络中有一台包含一些弱点的主机，用来检测网络安全漏洞，可能希望不理会对这台机器的攻击，pass规则这时就可以用到了。
2. ###### log

   log动作用来记录包，记录包有不同的方式，例如：可以记录到文件或者数据库。根据命令行参数和配置文件，包可以被记录为不同的详细程度。你可以用"snort -?"命令来查看你所用的Snort版本的命令行参数。
3. ###### alert

   alert动作用来在一个包符合规则条件时发送告警信息。告警的发送有多种方式，例如可以发送到文件或者控制台。log动作与alert动作不同在于：alert动作是发送告警然后记录包，log动作仅仅记录包。
4. ###### active-dynamic

   active报警并且激活另一条dynamic规则。Activate动作用来产生告警然后激活其它规则来进行进一步的检验。dynamic规则动作由其他activate动作的规则调用，在正常情况下，他们不会被用来检测包。一个动态规则仅能被一个"activate"动作激活。
5. 还可以有一些自定义动作

**·规则选项**

规则选项组成了snort入侵检测引擎的核心，既易用又强大还灵活。所有的snort规则选项用分号”；”隔开。规则选项关键字和它们的参数用冒号”:”分开。


# 大模型与网络安全

[SecCorpus: 构建安全领域大模型数据的技术实践 | 腾讯科恩实验室官方博客 (tencent.com)](https://keenlab.tencent.com/zh/2024/04/11/2024-SecCorpus0411/)
